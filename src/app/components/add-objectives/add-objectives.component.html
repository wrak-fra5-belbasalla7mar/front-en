<div class="container mt-4">
  <h2>Add Objective</h2>
  <div *ngIf="successMessage" class="alert alert-success">{{ successMessage }}</div>
  <div *ngIf="errorMessage" class="alert alert-danger">{{ errorMessage }}</div>
  <form #objectiveForm="ngForm" (ngSubmit)="objectiveForm.valid && saveObjective()">
    <div class="mb-3">
      <label class="form-label">Assign To</label>
      <select class="form-select" [(ngModel)]="newObjective.assignedUserId" name="assignedUser" (ngModelChange)="selectMember(newObjective.assignedUserId)" required>
        <option [ngValue]="null" disabled>Select a team member</option>
        <option *ngFor="let member of teamMembers" [ngValue]="member.userId">{{ member.name }}</option>
      </select>
    </div>
    <div class="mb-3">
      <label class="form-label">Title</label>
      <input type="text" class="form-control" [(ngModel)]="newObjective.title" name="title" required maxlength="100" />
    </div>
    <div class="mb-3">
      <label class="form-label">Description</label>
      <textarea class="form-control" [(ngModel)]="newObjective.description" name="description" required maxlength="500"></textarea>
    </div>
    <div class="mb-3">
      <label class="form-label">State</label>
      <select class="form-select" [(ngModel)]="newObjective.state" name="state" required>
        <option value="OPEN">Open</option>
        <option value="IN_PROGRESS">In Progress</option>
        <option value="COMPLETED">Completed</option>
      </select>
    </div>
    <div class="mb-3">
      <label class="form-label">Deadline</label>
      <input type="date" class="form-control" [(ngModel)]="newObjective.deadline" name="deadline" required />
    </div>
    <div class="button-group">
      <button type="submit" class="btn btn-primary" [disabled]="isLoading || objectiveForm.invalid">
        {{ isLoading ? 'Adding...' : 'Add Objective' }}
      </button>
      <button type="button" class="btn btn-secondary ms-2" (click)="cancelObjective()" [disabled]="isLoading">
        Cancel
      </button>
    </div>
  </form>
</div>